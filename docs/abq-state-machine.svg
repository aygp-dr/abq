<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.1 (20251213.1925)
 -->
<!-- Title: abq_state_machine Pages: 1 -->
<svg width="866pt" height="135pt"
 viewBox="0.00 0.00 866.00 135.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 130.51)">
<title>abq_state_machine</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-130.51 861.56,-130.51 861.56,4 -4,4"/>
<text xml:space="preserve" text-anchor="middle" x="428.78" y="-6.85" font-family="Helvetica,sans-Serif" font-size="12.00">ABQ Message State Machine â€” file&#45;based agent bus queue lifecycle</text>
<!-- requests -->
<g id="node1" class="node">
<title>requests</title>
<path fill="#e8f4fd" stroke="black" d="M251.31,-99.25C251.31,-99.25 207.56,-99.25 207.56,-99.25 201.56,-99.25 195.56,-93.25 195.56,-87.25 195.56,-87.25 195.56,-75.25 195.56,-75.25 195.56,-69.25 201.56,-63.25 207.56,-63.25 207.56,-63.25 251.31,-63.25 251.31,-63.25 257.31,-63.25 263.31,-69.25 263.31,-75.25 263.31,-75.25 263.31,-87.25 263.31,-87.25 263.31,-93.25 257.31,-99.25 251.31,-99.25"/>
<text xml:space="preserve" text-anchor="middle" x="229.44" y="-77.55" font-family="Helvetica,sans-Serif" font-size="11.00">requests/</text>
</g>
<!-- processing -->
<g id="node2" class="node">
<title>processing</title>
<path fill="#e8f4fd" stroke="black" d="M452.56,-99.25C452.56,-99.25 397.56,-99.25 397.56,-99.25 391.56,-99.25 385.56,-93.25 385.56,-87.25 385.56,-87.25 385.56,-75.25 385.56,-75.25 385.56,-69.25 391.56,-63.25 397.56,-63.25 397.56,-63.25 452.56,-63.25 452.56,-63.25 458.56,-63.25 464.56,-69.25 464.56,-75.25 464.56,-75.25 464.56,-87.25 464.56,-87.25 464.56,-93.25 458.56,-99.25 452.56,-99.25"/>
<text xml:space="preserve" text-anchor="middle" x="425.06" y="-77.55" font-family="Helvetica,sans-Serif" font-size="11.00">processing/</text>
</g>
<!-- requests&#45;&gt;processing -->
<g id="edge2" class="edge">
<title>requests&#45;&gt;processing</title>
<path fill="none" stroke="#007bff" d="M263.72,-81.25C294.03,-81.25 339.21,-81.25 373.9,-81.25"/>
<polygon fill="#007bff" stroke="#007bff" points="373.71,-84.75 383.71,-81.25 373.71,-77.75 373.71,-84.75"/>
<text xml:space="preserve" text-anchor="middle" x="324.44" y="-97.25" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#007bff"> &#160;recv() / watch()</text>
<text xml:space="preserve" text-anchor="middle" x="324.44" y="-84.5" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#007bff"> &#160;atomic rename &#160;</text>
</g>
<!-- handler -->
<g id="node5" class="node">
<title>handler</title>
<polygon fill="#fff3cd" stroke="black" points="603.56,-114.75 550.81,-81.25 603.56,-47.75 656.31,-81.25 603.56,-114.75"/>
<text xml:space="preserve" text-anchor="middle" x="603.56" y="-84.5" font-family="Helvetica,sans-Serif" font-size="10.00">agent</text>
<text xml:space="preserve" text-anchor="middle" x="603.56" y="-71.75" font-family="Helvetica,sans-Serif" font-size="10.00">handler</text>
</g>
<!-- processing&#45;&gt;handler -->
<g id="edge3" class="edge">
<title>processing&#45;&gt;handler</title>
<path fill="none" stroke="#6f42c1" d="M464.8,-81.25C486.43,-81.25 513.94,-81.25 538.68,-81.25"/>
<polygon fill="#6f42c1" stroke="#6f42c1" points="538.68,-84.75 548.68,-81.25 538.68,-77.75 538.68,-84.75"/>
<text xml:space="preserve" text-anchor="middle" x="507.69" y="-97.25" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#6f42c1"> &#160;read &amp;</text>
<text xml:space="preserve" text-anchor="middle" x="507.69" y="-84.5" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#6f42c1"> &#160;execute &#160;</text>
</g>
<!-- responses -->
<g id="node3" class="node">
<title>responses</title>
<path fill="#e8f4fd" stroke="black" d="M845.56,-126.25C845.56,-126.25 793.56,-126.25 793.56,-126.25 787.56,-126.25 781.56,-120.25 781.56,-114.25 781.56,-114.25 781.56,-102.25 781.56,-102.25 781.56,-96.25 787.56,-90.25 793.56,-90.25 793.56,-90.25 845.56,-90.25 845.56,-90.25 851.56,-90.25 857.56,-96.25 857.56,-102.25 857.56,-102.25 857.56,-114.25 857.56,-114.25 857.56,-120.25 851.56,-126.25 845.56,-126.25"/>
<text xml:space="preserve" text-anchor="middle" x="819.56" y="-104.55" font-family="Helvetica,sans-Serif" font-size="11.00">responses/</text>
</g>
<!-- archive -->
<g id="node4" class="node">
<title>archive</title>
<path fill="#e8f4fd" stroke="black" d="M837.69,-72.25C837.69,-72.25 801.44,-72.25 801.44,-72.25 795.44,-72.25 789.44,-66.25 789.44,-60.25 789.44,-60.25 789.44,-48.25 789.44,-48.25 789.44,-42.25 795.44,-36.25 801.44,-36.25 801.44,-36.25 837.69,-36.25 837.69,-36.25 843.69,-36.25 849.69,-42.25 849.69,-48.25 849.69,-48.25 849.69,-60.25 849.69,-60.25 849.69,-66.25 843.69,-72.25 837.69,-72.25"/>
<text xml:space="preserve" text-anchor="middle" x="819.56" y="-50.55" font-family="Helvetica,sans-Serif" font-size="11.00">archive/</text>
</g>
<!-- handler&#45;&gt;responses -->
<g id="edge4" class="edge">
<title>handler&#45;&gt;responses</title>
<path fill="none" stroke="#fd7e14" d="M648.39,-86.78C683.69,-91.23 733.3,-97.49 769.85,-102.1"/>
<polygon fill="#fd7e14" stroke="#fd7e14" points="769.36,-105.57 779.72,-103.35 770.24,-98.63 769.36,-105.57"/>
<text xml:space="preserve" text-anchor="middle" x="718.94" y="-117.01" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#fd7e14"> &#160;respond()</text>
<text xml:space="preserve" text-anchor="middle" x="718.94" y="-104.26" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#fd7e14"> &#160;write result &#160;</text>
</g>
<!-- handler&#45;&gt;archive -->
<g id="edge5" class="edge">
<title>handler&#45;&gt;archive</title>
<path fill="none" stroke="#6c757d" d="M639.35,-69.9C650.41,-66.73 662.77,-63.64 674.31,-61.75 708.9,-56.09 748.71,-54.37 777.73,-53.98"/>
<polygon fill="#6c757d" stroke="#6c757d" points="777.59,-57.48 787.56,-53.9 777.53,-50.48 777.59,-57.48"/>
<text xml:space="preserve" text-anchor="middle" x="718.94" y="-77.75" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#6c757d"> &#160;respond()</text>
<text xml:space="preserve" text-anchor="middle" x="718.94" y="-65" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#6c757d"> &#160;rename original &#160;</text>
</g>
<!-- sender -->
<g id="node6" class="node">
<title>sender</title>
<ellipse fill="#d4edda" stroke="black" cx="47.91" cy="-81.25" rx="47.91" ry="23.69"/>
<text xml:space="preserve" text-anchor="middle" x="47.91" y="-84.5" font-family="Helvetica,sans-Serif" font-size="10.00">sender</text>
<text xml:space="preserve" text-anchor="middle" x="47.91" y="-71.75" font-family="Helvetica,sans-Serif" font-size="10.00">(abq send)</text>
</g>
<!-- sender&#45;&gt;requests -->
<g id="edge1" class="edge">
<title>sender&#45;&gt;requests</title>
<path fill="none" stroke="#28a745" d="M96.08,-81.25C123.23,-81.25 157.14,-81.25 183.85,-81.25"/>
<polygon fill="#28a745" stroke="#28a745" points="183.67,-84.75 193.67,-81.25 183.67,-77.75 183.67,-84.75"/>
<text xml:space="preserve" text-anchor="middle" x="145.69" y="-97.25" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#28a745"> &#160;send()</text>
<text xml:space="preserve" text-anchor="middle" x="145.69" y="-84.5" font-family="Helvetica,sans-Serif" font-size="10.00" fill="#28a745"> &#160;write JSON &#160;</text>
</g>
</g>
</svg>
